<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="./assets/img/logo.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    Sawaal
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
    name='viewport' />
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css"
    href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <!-- CSS Files -->
  <link href="./assets/css/material-dashboard.css?v=2.1.0" rel="stylesheet" />
</head>

<body class="">
  <nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top ">
    <button class="navbar-toggler" type="button" data-toggle="collapse" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="navbar-toggler-icon icon-bar"></span>
        <span class="navbar-toggler-icon icon-bar"></span>
        <span class="navbar-toggler-icon icon-bar"></span>
    </button>
  </nav>
  <div class="wrapper ">
      <div class="sidebar" data-color="purple" data-background-color="white" data-image="./assets/img/sidebar-1.jpg">
        <div class="logo">
          <a href="/" class="simple-text logo-normal">
            <img style="-webkit-filter: drop-shadow(1px 1px 1px black) drop-shadow(1px -1px 1px black); filter: drop-shadow(1px 1px 1px black) drop-shadow(-1px -1px 1px black);" src="assets/img/logo.png" width="100" height="100"/>
          </a>
        </div>
        <div class="sidebar-wrapper">
          <ul class="nav">
            <li class="nav-item active">
              <a class="nav-link" href="/">
                <i class="material-icons">search</i>
                <p>Find Paper</p>
              </a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="leaderboard">
                <i class="material-icons">star</i>
                <p>Leaderboard</p>
              </a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="about">
                <i class="material-icons">info_outline</i>
                <p>About</p>
              </a>
            </li>
          </ul>
        </div>
      </div>
    <div class="main-panel">
      <div class="content">
        <div class="container-fluid">
          <%- include('loading') %>
          <div class="row maincontent" hidden>
            <div class="col-md-8" style="margin: 0 auto">
              <div class="card card-profile">
                <div class="card-avatar">
                  <a href="#pablo">
                    <img id="profileimg" class="img" src="../assets/img/logo.png" />
                  </a>
                </div>
                <div class="card-body">
                  <h4 id="profilename" class="card-title">Shashwat Jolly</h4>
                  <h3 id="profilescore" class="card-title">Score: 10</h3>
                  <div style="width: max-content; margin: 0 auto; margin-top: 24px; margin-bottom: 24px">
                    <div class="row" style="width: max-content; height: 24px; margin-bottom: 16px">
                      <i class="material-icons" style="font-size: 24px; margin-right: 16px;">email</i>                    
                      <h4 id="profileemail" style="line-height: 24px">
                      </h4>
                    </div>
                    <div class="row" style="width: max-content; height: 24px; margin-bottom: 16px">
                      <i class="material-icons" style="font-size: 24px; margin-right: 16px;">school</i>                    
                      <h4 id="profileroll" style="line-height: 24px">
                      </h4>
                    </div>
                  </div>
                  <a href="#pablo" class="btn btn-primary btn-round">Sign out</a>
                </div>
              </div>
            </div>
        </div>
        </div>
      </div>
      <%- include('footer') %>
    </div>
  </div>
  <!--   Core JS Files   -->
  <script src="./assets/js/core/jquery.min.js" type="text/javascript"></script>
  <script src="./assets/js/core/popper.min.js" type="text/javascript"></script>
  <script src="./assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
  <script src="./assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <!--  Google Maps Plugin    -->
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>
  <!-- Chartist JS -->
  <script src="./assets/js/plugins/chartist.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src="./assets/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="./assets/js/material-dashboard.min.js?v=2.1.0" type="text/javascript"></script>
  <!-- Material Dashboard DEMO methods, don't include it in your project! -->
  <script src="./assets/demo/demo.js"></script>
  <%- include('auth') %>
  <script>
    var MATERIAL = [
        "e57373",
        "f06292",
        "ba68c8",
        "9575cd",
        "7986cb",
        "64b5f6",
        "4fc3f7",
        "4dd0e1",
        "4db6ac",
        "81c784",
        "aed581",
        "ff8a65",
        "d4e157",
        "ffd54f",
        "ffb74d",
        "a1887f",
        "90a4ae"
    ];
    hashCode = function(s) {
        var h = 0, l = s.length, i = 0;
        if ( l > 0 )
            while (i < l)
            h = (h << 5) - h + s.charCodeAt(i++) | 0;
        return h;
    }
    getSrc = function(email, name) {
        var hashcode = hashCode(email);
        var col = MATERIAL[Math.abs(hashcode)%MATERIAL.length];
        var words = name.split(" ");
        var tname = words[0] + "+" + words[words.length-1];
        var src = "https://ui-avatars.com/api/?background=" + col + "&color=fff&rounded=true&name=" + tname;
        return src;
    }
    $(document).ready(function() {
      var t;
      firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
          var referString = `Users/` + user.uid;
            var databaseRef = firebase.database();
            var userRef = databaseRef.ref(referString);
            userRef.once("value").then(function(snapshot) {
                console.log(snapshot);
                snapshot.forEach(function(child) {
                    $("#profileemail").html(user.email)
                    $("#profilename").html(user.displayName)
                    console.log(child.val());
                    $("#profilescore").html(child.val().Score)
                    $("#profileroll").html(child.val().Rollno)
                });
                }, function (errorObject) {
                console.log("The read failed: " + errorObject.code);
            });  
        }
      });
    });

  </script>
</body>

</html>