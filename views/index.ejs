<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="./assets/img/logo.png">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>
    Sawaal
  </title>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
    name='viewport' />
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css"
    href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <!-- CSS Files -->
  <link href="./assets/css/material-dashboard.css?v=2.1.0" rel="stylesheet" />
</head>

<body class="">
  <div class="wrapper ">
    <%- include('navsidebar') %>
    <div class="main-panel">
      <div class="content">
        <div class="container-fluid">
          <div class="row">
            <div class="col-md-9" style="margin: 0 auto">

              <% for (var i = 0; i < papers.length; i++) { %>

                <%if ( "isYear" in papers[i]) { %>
              <div class="card">
                  <div class="card-body">
                    <div class="row" style="margin-left: 60px">
                        <div class="col-md-12" style="text-align: center">
                            <h3><%- papers[i].year %></h3> 
                        </div>
                    </div>
                  </div>
                </div>
                

                  <% } else { %>

              <div class="card">
                <div class="card-body">
                  <div style="width:41px; position: absolute; top: 50%; -moz-transform: translateY(-50%); -webkit-transform: translateY(-50%); transform: translateY(-50%);">
                    
                    <%if (papers[i].hasupvoted) { %>

                    <button class="btn btn-round btn-just-icon btn-primary upvote active" id="u<%- i %>" style="font-size: 29;"
                      onclick="clicked(true,'u<%- i %>','d<%- i %>','t<%- i %>')">
                    <i class="material-icons" style="font-size: 1.2em; text-align: center" >keyboard_arrow_up</i>
                    </button>

                    <% } else { %>
                      
                      <button class="btn btn-round btn-just-icon btn-primary upvote" id="u<%- i %>" style="font-size: 29;"
                          onclick="clicked(true,'u<%- i %>','d<%- i %>','t<%- i %>')">
                      <i class="material-icons" style="font-size: 1.2em; text-align: center" >keyboard_arrow_up</i>
                      </button> 

                    <% } %>

                    <h4 style="text-align: center; margin-bottom: 0" id="t<%- i %>"><%- papers[i].totalVotes %></h4>

                    <%if (papers[i].hasdownvoted) { %>

                    <button class="btn btn-round btn-just-icon btn-primary downvote active" id="d<%- i %>" style="font-size: 29;"
                        onclick="clicked(false,'d<%- i %>','u<%- i %>','t<%- i %>')">
                      <i class="material-icons" style="font-size: 1.2em; text-align: center" >keyboard_arrow_down</i>
                    </button>

                    <% } else { %>

                      <button class="btn btn-round btn-just-icon btn-primary downvote" id="d<%- i %>"  style="font-size: 29;"
                          onclick="clicked(false,'d<%- i %>','u<%- i %>','t<%- i %>')">
                          <i class="material-icons" style="font-size: 1.2em; text-align: center" >keyboard_arrow_down</i>
                        </button> 

                    <% } %>

                  </div>
                  <div class="row" style="margin-left: 60px">
                    <h3 class="col-md-4 card-title" style="text-align: center"><%- papers[i].CourseCode %></h4>
                    <h3 class="col-md-4 card-title" style="text-align: center"><%- papers[i].Type %></h4>
                    <h3 class="col-md-4 card-title" style="text-align: center"><%- papers[i].Year %></h4>
                  </div>
                  <div class="row" style="margin-left: 60px">
                      <div class="col-md-12" style="text-align: center">
                          <h5>Prof: <%- papers[i].Prof %></h5> 
                      </div>
                  </div>
                  <div class="row" style="margin-left: 60px">
                      <div class="col-md-12" style="text-align: center">
                          <a href="<%- papers[i].FileUrl %>" target="_blank" class="btn btn-primary btn-round">Download</a>
                      </div>
                  </div>
                </div>
              </div>

              <% } %>
              <% }; %>
            </div>
          </div>
        </div>
      </div>
      <%- include('footer') %>
    </div>
  </div>
  <!--   Core JS Files   -->
  <script src="./assets/js/core/jquery.min.js" type="text/javascript"></script>
  <script src="./assets/js/core/popper.min.js" type="text/javascript"></script>
  <script src="./assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
  <script src="./assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <!--  Google Maps Plugin    -->
  <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>
  <!-- Chartist JS -->
  <script src="./assets/js/plugins/chartist.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src="./assets/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="./assets/js/material-dashboard.min.js?v=2.1.0" type="text/javascript"></script>
  <!-- Material Dashboard DEMO methods, don't include it in your project! -->
  <script src="./assets/demo/demo.js"></script>
  <script>
    $(document).ready(function () {
      // Javascript method's body can be found in assets/js/demos.js
      md.initDashboardPageCharts();
    });

    function clicked(isUpvote,myId,otherId,textId){

      var mainSelector = '#'+myId;
      var otherSelector = '#'+otherId;
      var textSelector = '#'+textId;

      
      if(isUpvote){
        if($(mainSelector).hasClass("active")){
          $(mainSelector).removeClass("active");
          $(mainSelector).blur();

          var votes = Number($(textSelector).text());
          $(textSelector).text(votes-1);
        }
        else{
          $(mainSelector).addClass("active");
          $(mainSelector).blur();
          var votes = Number($(textSelector).text());

          if($(otherSelector).hasClass("active")){
              $(otherSelector).removeClass("active");
              $(textSelector).text(votes+2);
          }
          else{
              $(textSelector).text(votes+1);
          }

        }
      }
      else{
        if($(mainSelector).hasClass("active")){
          $(mainSelector).removeClass("active");
          $(mainSelector).blur();

          var votes = Number($(textSelector).text());
          $(textSelector).text(votes+1);
        }
        else{
          $(mainSelector).addClass("active");
          $(mainSelector).blur();
          var votes = Number($(textSelector).text());

          if($(otherSelector).hasClass("active")){
              $(otherSelector).removeClass("active");
              $(textSelector).text(votes-2);
          }
          else{
              $(textSelector).text(votes-1);
          }

        }
      }

    }


  </script>
</body>

</html>